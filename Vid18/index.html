<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    
    <!-- ========== KONFIGURASI VIDEO (EDIT DI SINI) ========== -->
    <script>
        // Daftar video - tambahkan nomor baru di sini jika mau nambah video
        const VIDEO_CONFIG = {
            folder: 'assets/video/',
            extension: '.mp4',
            numbers: Array.from({length: 28}, (_, i) => i + 2), // [2, 3, 4, ..., 29]
        };
    </script>
    <!-- ====================================================== -->
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0f0f0f;
            min-height: 100vh;
            color: #fff;
        }

        .header {
            background: #212121;
            padding: 15px 20px;
            border-bottom: 1px solid #333;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 500;
            color: #fff;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 0;
            min-height: calc(100vh - 70px);
        }

        .player-section {
            background: #181818;
            padding: 20px;
        }

        .video-wrapper {
            position: relative;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        video {
            width: 100%;
            display: block;
            max-height: 600px;
            background: #000;
        }

        video::-webkit-media-controls-start-playback-button {
            display: none !important;
        }

        .controls {
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 15px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .video-wrapper:hover .controls {
            opacity: 1;
        }

        .progress-container {
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }

        .progress {
            height: 100%;
            background: #ff0000;
            border-radius: 2px;
            width: 0%;
            transition: width 0.1s;
        }

        .control-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            background: transparent;
            border: none;
            color: #fff;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .btn.active {
            background: #ff0000;
        }

        .time-display {
            margin-left: auto;
            font-size: 13px;
            color: #aaa;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .volume-slider {
            width: 60px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            outline: none;
            border-radius: 2px;
        }

        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 12px;
            height: 12px;
            background: #fff;
            border-radius: 50%;
            cursor: pointer;
        }

        .info-panel {
            background: #212121;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .current-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
            color: #fff;
        }

        .video-info {
            font-size: 13px;
            color: #aaa;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .shuffle-status {
            color: #ff0000;
            font-weight: 500;
        }

        .playlist-section {
            background: #212121;
            border-left: 1px solid #333;
            display: flex;
            flex-direction: column;
        }

        .playlist-header {
            padding: 20px;
            border-bottom: 1px solid #333;
        }

        .search-box {
            position: relative;
            margin-bottom: 15px;
        }

        .search-input {
            width: 100%;
            padding: 10px 35px 10px 12px;
            border: 1px solid #333;
            border-radius: 20px;
            background: #0f0f0f;
            color: #fff;
            font-size: 14px;
            outline: none;
        }

        .search-input:focus {
            border-color: #666;
        }

        .search-input::placeholder {
            color: #666;
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            color: #666;
        }

        .playlist-title {
            font-size: 16px;
            font-weight: 500;
            color: #fff;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .shuffle-btn {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
            border: 1px solid #333;
            background: transparent;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }

        .shuffle-btn:hover {
            background: #333;
        }

        .shuffle-btn.active {
            background: #ff0000;
            border-color: #ff0000;
        }

        .playlist {
            flex: 1;
            overflow-y: auto;
            padding: 0 20px 20px;
        }

        .playlist-item {
            padding: 10px 12px;
            margin-bottom: 2px;
            background: transparent;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .playlist-item:hover {
            background: #333;
        }

        .playlist-item.active {
            background: #333;
            border-left: 3px solid #ff0000;
        }

        .playlist-item-number {
            background: #333;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
            min-width: 35px;
            text-align: center;
            font-size: 12px;
            color: #aaa;
        }

        .playlist-item.active .playlist-item-number {
            background: #ff0000;
            color: #fff;
        }

        .playlist-item-title {
            flex: 1;
            font-size: 14px;
            color: #fff;
        }

        .playlist::-webkit-scrollbar {
            width: 6px;
        }

        .playlist::-webkit-scrollbar-track {
            background: transparent;
        }

        .playlist::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 3px;
        }

        .playlist::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .no-results {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            font-size: 14px;
        }

        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            font-size: 14px;
        }

        @media (max-width: 968px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .playlist-section {
                border-left: none;
                border-top: 1px solid #333;
            }
        }

        /* Icons using Unicode symbols */
        .icon-play::before { content: "‚ñ∂"; }
        .icon-pause::before { content: "‚ùö‚ùö"; }
        .icon-prev::before { content: "‚èÆ"; }
        .icon-next::before { content: "‚è≠"; }
        .icon-volume-high::before { content: "üîä"; }
        .icon-volume-low::before { content: "üîâ"; }
        .icon-volume-mute::before { content: "üîá"; }
        .icon-fullscreen::before { content: "‚õ∂"; }
        .icon-search::before { content: "üîç"; }
        .icon-shuffle::before { content: "‚áÑ"; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Video Player</h1>
    </div>

    <div class="container">
        <div class="player-section">
            <div class="video-wrapper">
                <video id="videoPlayer" controls preload="auto">
                    <source id="videoSource" src="" type="video/mp4">
                    Browser Anda tidak mendukung video player.
                </video>
                
                <div class="controls">
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar">
                            <div class="progress" id="progress"></div>
                        </div>
                    </div>
                    
                    <div class="control-buttons">
                        <button class="btn icon-prev" id="prevBtn"></button>
                        <button class="btn icon-play" id="playPauseBtn"></button>
                        <button class="btn icon-next" id="nextBtn"></button>
                        <button class="btn icon-shuffle" id="shuffleBtn" title="Shuffle"></button>
                        
                        <div class="volume-control">
                            <button class="btn icon-volume-high" id="muteBtn"></button>
                            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="70">
                        </div>
                        
                        <button class="btn icon-fullscreen" id="fullscreenBtn"></button>
                        
                        <div class="time-display">
                            <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="info-panel">
                <div class="current-title" id="currentTitle">Pilih video untuk diputar</div>
                <div class="video-info">
                    <span>Total Video: <span id="totalVideos">Memuat...</span></span>
                    <span class="shuffle-status" id="shuffleStatus">Shuffle: OFF</span>
                </div>
            </div>
        </div>

        <div class="playlist-section">
            <div class="playlist-header">
                <div class="search-box">
                    <input type="text" class="search-input" id="searchInput" placeholder="Cari video...">
                    <span class="search-icon icon-search"></span>
                </div>
                <div class="playlist-title">
                    <span>Daftar Video</span>
                    <button class="shuffle-btn" id="shuffleToggle">üîÄ ACAK</button>
                </div>
            </div>
            
            <div class="playlist">
                <div id="playlistContainer">
                    <div class="loading">Memuat daftar video...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Elements
        const videoPlayer = document.getElementById('videoPlayer');
        const videoSource = document.getElementById('videoSource');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const shuffleBtn = document.getElementById('shuffleBtn');
        const progressBar = document.getElementById('progressBar');
        const progress = document.getElementById('progress');
        const currentTimeEl = document.getElementById('currentTime');
        const durationEl = document.getElementById('duration');
        const volumeSlider = document.getElementById('volumeSlider');
        const muteBtn = document.getElementById('muteBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const currentTitle = document.getElementById('currentTitle');
        const totalVideos = document.getElementById('totalVideos');
        const searchInput = document.getElementById('searchInput');
        const playlistContainer = document.getElementById('playlistContainer');
        const shuffleToggle = document.getElementById('shuffleToggle');
        const shuffleStatus = document.getElementById('shuffleStatus');

        let videos = [];
        let currentVideoIndex = 0;
        let filteredVideos = [];
        let shuffleMode = false;
        let shuffledIndices = [];
        let shufflePosition = 0;

        // Initialize - Set volume dan pastikan tidak muted
        videoPlayer.volume = 0.7;
        videoPlayer.muted = false;
        
        // Shuffle array function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Generate shuffled indices
        function generateShuffledIndices() {
            const indices = Array.from({length: videos.length}, (_, i) => i);
            shuffledIndices = shuffleArray(indices);
            
            // Pastikan video current ada di posisi pertama
            const currentIndex = shuffledIndices.indexOf(currentVideoIndex);
            if (currentIndex > 0) {
                [shuffledIndices[0], shuffledIndices[currentIndex]] = [shuffledIndices[currentIndex], shuffledIndices[0]];
            }
            shufflePosition = 0;
        }

        // Toggle shuffle mode
        function toggleShuffle() {
            shuffleMode = !shuffleMode;
            
            if (shuffleMode) {
                generateShuffledIndices();
                shuffleBtn.classList.add('active');
                shuffleToggle.classList.add('active');
                shuffleStatus.textContent = 'Shuffle: ON';
            } else {
                shuffleBtn.classList.remove('active');
                shuffleToggle.classList.remove('active');
                shuffleStatus.textContent = 'Shuffle: OFF';
            }
        }

        // Get next video index
        function getNextVideoIndex() {
            if (shuffleMode) {
                shufflePosition = (shufflePosition + 1) % shuffledIndices.length;
                return shuffledIndices[shufflePosition];
            } else {
                return (currentVideoIndex + 1) % videos.length;
            }
        }

        // Get previous video index
        function getPrevVideoIndex() {
            if (shuffleMode) {
                shufflePosition = (shufflePosition - 1 + shuffledIndices.length) % shuffledIndices.length;
                return shuffledIndices[shufflePosition];
            } else {
                return (currentVideoIndex - 1 + videos.length) % videos.length;
            }
        }

        // Deteksi video yang benar-benar ada
        async function detectAvailableVideos() {
            const availableVideos = [];
            
            for (const num of VIDEO_CONFIG.numbers) {
                const videoPath = `${VIDEO_CONFIG.folder}${num}${VIDEO_CONFIG.extension}`;
                
                try {
                    const response = await fetch(videoPath, { method: 'HEAD' });
                    if (response.ok) {
                        availableVideos.push({
                            number: num,
                            title: `Video ${num}`,
                            src: videoPath
                        });
                    }
                } catch (error) {
                    console.log(`Video ${num} tidak ditemukan`);
                    continue;
                }
            }
            
            return availableVideos;
        }

        // Initialize videos
        async function initializePlayer() {
            try {
                videos = await detectAvailableVideos();
                filteredVideos = [...videos];
                
                totalVideos.textContent = videos.length;
                renderPlaylist();
                
                if (videos.length > 0) {
                    // Mulai dengan video acak
                    currentVideoIndex = Math.floor(Math.random() * videos.length);
                    loadVideo(currentVideoIndex);
                    videoPlayer.pause();
                    updatePlayPauseIcon();
                } else {
                    playlistContainer.innerHTML = '<div class="no-results">Tidak ada video ditemukan di folder assets/video/</div>';
                }
            } catch (error) {
                console.error('Error loading videos:', error);
                playlistContainer.innerHTML = '<div class="no-results">Error memuat video</div>';
            }
        }

        // Render playlist
        function renderPlaylist() {
            playlistContainer.innerHTML = '';
            
            if (filteredVideos.length === 0) {
                playlistContainer.innerHTML = '<div class="no-results">Tidak ada video ditemukan</div>';
                return;
            }
            
            filteredVideos.forEach((video, index) => {
                const item = document.createElement('div');
                item.className = 'playlist-item';
                if (videos[currentVideoIndex] === video) {
                    item.classList.add('active');
                }
                item.innerHTML = `
                    <div class="playlist-item-number">${video.number}</div>
                    <div class="playlist-item-title">${video.title}</div>
                `;
                item.onclick = () => {
                    const videoIndex = videos.indexOf(video);
                    loadVideo(videoIndex);
                    
                    // Update shuffle position jika shuffle mode aktif
                    if (shuffleMode) {
                        shufflePosition = shuffledIndices.indexOf(videoIndex);
                    }
                };
                playlistContainer.appendChild(item);
            });
        }

        // Load video dengan frame pertama
        function loadVideo(index) {
            if (index < 0 || index >= videos.length) return;
            
            currentVideoIndex = index;
            const video = videos[index];
            
            videoSource.src = video.src;
            videoPlayer.load();
            
            // Pastikan suara aktif setiap kali load video baru
            videoPlayer.muted = false;
            videoPlayer.volume = volumeSlider.value / 100;
            
            // Event listener untuk menampilkan frame pertama
            videoPlayer.addEventListener('loadeddata', function showFirstFrame() {
                videoPlayer.currentTime = 0.1;
                videoPlayer.removeEventListener('loadeddata', showFirstFrame);
            });

            videoPlayer.addEventListener('error', function(e) {
                console.error('Error loading video:', e);
                currentTitle.textContent = `Error: ${video.title}`;
            });

            currentTitle.textContent = video.title;
            updateMuteIcon();
            renderPlaylist();
        }

        // Update play/pause icon
        function updatePlayPauseIcon() {
            if (videoPlayer.paused) {
                playPauseBtn.className = 'btn icon-play';
            } else {
                playPauseBtn.className = 'btn icon-pause';
            }
        }

        // Play/Pause
        playPauseBtn.onclick = () => {
            if (videoPlayer.paused) {
                videoPlayer.play();
            } else {
                videoPlayer.pause();
            }
        };

        videoPlayer.onplay = updatePlayPauseIcon;
        videoPlayer.onpause = updatePlayPauseIcon;

        // Previous
        prevBtn.onclick = () => {
            const prevIndex = getPrevVideoIndex();
            loadVideo(prevIndex);
            videoPlayer.play();
        };

        // Next
        nextBtn.onclick = () => {
            const nextIndex = getNextVideoIndex();
            loadVideo(nextIndex);
            videoPlayer.play();
        };

        // Shuffle button
        shuffleBtn.onclick = toggleShuffle;
        shuffleToggle.onclick = toggleShuffle;

        // Auto play next
        videoPlayer.onended = () => {
            nextBtn.click();
        };

        // Progress bar
        videoPlayer.ontimeupdate = () => {
            if (videoPlayer.duration) {
                const percent = (videoPlayer.currentTime / videoPlayer.duration) * 100;
                progress.style.width = percent + '%';
                currentTimeEl.textContent = formatTime(videoPlayer.currentTime);
            }
        };

        videoPlayer.onloadedmetadata = () => {
            durationEl.textContent = formatTime(videoPlayer.duration);
        };

        progressBar.onclick = (e) => {
            if (videoPlayer.duration) {
                const rect = progressBar.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                videoPlayer.currentTime = percent * videoPlayer.duration;
            }
        };

        // Volume
        volumeSlider.oninput = () => {
            videoPlayer.volume = volumeSlider.value / 100;
            videoPlayer.muted = false;
            updateMuteIcon();
        };

        muteBtn.onclick = () => {
            videoPlayer.muted = !videoPlayer.muted;
            updateMuteIcon();
        };

        function updateMuteIcon() {
            if (videoPlayer.muted || videoPlayer.volume === 0) {
                muteBtn.className = 'btn icon-volume-mute';
            } else if (videoPlayer.volume < 0.5) {
                muteBtn.className = 'btn icon-volume-low';
            } else {
                muteBtn.className = 'btn icon-volume-high';
            }
        }

        // Fullscreen
        fullscreenBtn.onclick = () => {
            if (!document.fullscreenElement) {
                videoPlayer.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        };

        // Search
        searchInput.oninput = () => {
            const query = searchInput.value.toLowerCase();
            filteredVideos = videos.filter(video => 
                video.title.toLowerCase().includes(query) ||
                video.number.toString().includes(query)
            );
            renderPlaylist();
        };

        // Format time
        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Keyboard shortcuts
        document.onkeydown = (e) => {
            if (e.target === searchInput) return;
            
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    playPauseBtn.click();
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    videoPlayer.currentTime += 5;
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    videoPlayer.currentTime -= 5;
                    break;
                case 'ArrowUp':
                    e.preventDefault();
                    videoPlayer.volume = Math.min(1, videoPlayer.volume + 0.1);
                    volumeSlider.value = videoPlayer.volume * 100;
                    updateMuteIcon();
                    break;
                case 'ArrowDown':
                    e.preventDefault();
                    videoPlayer.volume = Math.max(0, videoPlayer.volume - 0.1);
                    volumeSlider.value = videoPlayer.volume * 100;
                    updateMuteIcon();
                    break;
                case 's':
                case 'S':
                    e.preventDefault();
                    toggleShuffle();
                    break;
            }
        };

        // Start the app
        initializePlayer();
    </script>
</body>
</html>