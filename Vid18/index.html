<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    
    <script>
        const VIDEO_CONFIG = {
            folder: 'assets/video/',
            extension: '.mp4',
            numbers: Array.from({length: 41}, (_, i) => i + 2),
        };
    </script>
    
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',sans-serif;background:#0f0f0f;min-height:100vh;color:#fff}
        .header{background:#212121;padding:15px 20px;border-bottom:1px solid #333;display:flex;justify-content:space-between;align-items:center}
        .header h1{font-size:24px;color:#fff}
        .theme-toggle{padding:6px 12px;background:#333;border:none;border-radius:4px;color:#fff;cursor:pointer;font-size:12px;transition:background .2s}
        .theme-toggle:hover{background:#444}
        .container{max-width:1400px;margin:0 auto;display:grid;grid-template-columns:1fr 350px;gap:0;min-height:calc(100vh - 70px)}
        .player-section{background:#181818;padding:20px}
        .video-wrapper{position:relative;background:#000;border-radius:8px;overflow:hidden;margin-bottom:20px}
        video{width:100%;display:block;max-height:600px;background:#000}
        .video-overlay{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.7);z-index:5;opacity:0;pointer-events:none;transition:opacity .3s}
        .video-overlay.show{opacity:1;pointer-events:auto}
        .loading-spinner{border:3px solid rgba(255,255,255,.3);border-top:3px solid #ff0000;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite}
        @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
        .controls{background:linear-gradient(to top,rgba(0,0,0,.8),transparent);position:absolute;bottom:0;left:0;right:0;padding:15px;opacity:0;transition:opacity .3s;z-index:10}
        .video-wrapper:hover .controls{opacity:1}
        .progress-container{margin-bottom:10px;position:relative}
        .progress-bar{width:100%;height:4px;background:rgba(255,255,255,.3);border-radius:2px;cursor:pointer;position:relative}
        .progress{height:100%;background:#ff0000;border-radius:2px;width:0%;transition:width .1s;position:relative}
        .progress-handle{position:absolute;right:-6px;top:50%;transform:translateY(-50%);width:12px;height:12px;background:#fff;border-radius:50%;opacity:0;transition:opacity .2s}
        .progress-bar:hover .progress-handle{opacity:1}
        .buffer-progress{position:absolute;height:100%;background:rgba(255,255,255,.5);border-radius:2px;width:0%;top:0;left:0}
        .progress-tooltip{position:absolute;bottom:100%;left:0;background:rgba(0,0,0,.9);color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;margin-bottom:8px;opacity:0;pointer-events:none;white-space:nowrap}
        .progress-container:hover .progress-tooltip{opacity:1}
        .control-buttons{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
        .btn{background:transparent;border:none;color:#fff;padding:8px;border-radius:4px;cursor:pointer;font-size:18px;transition:background .2s;display:flex;align-items:center;justify-content:center;width:40px;height:40px;position:relative}
        .btn:hover{background:rgba(255,255,255,.1)}
        .btn.active{background:#ff0000}
        .btn:disabled{opacity:.3;cursor:not-allowed}
        .btn[title]:hover::after{content:attr(title);position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.9);color:#fff;padding:4px 8px;border-radius:4px;font-size:11px;white-space:nowrap;margin-bottom:8px;z-index:1000}
        .time-display{margin-left:auto;font-size:13px;color:#aaa}
        .volume-control{display:flex;align-items:center;gap:8px}
        .volume-slider{width:60px;height:4px;background:rgba(255,255,255,.3);outline:none;border-radius:2px}
        .volume-slider::-webkit-slider-thumb{appearance:none;width:12px;height:12px;background:#fff;border-radius:50%;cursor:pointer}
        .speed-control{position:relative}
        .speed-btn{font-size:12px;min-width:45px}
        .speed-menu{position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.95);border-radius:4px;padding:8px 0;margin-bottom:8px;display:none;min-width:80px;z-index:1000}
        .speed-menu.show{display:block}
        .speed-option{padding:8px 16px;cursor:pointer;font-size:13px;transition:background .2s}
        .speed-option:hover{background:rgba(255,255,255,.1)}
        .speed-option.active{background:#ff0000}
        .info-panel{background:#212121;padding:15px;border-radius:8px;margin-bottom:20px}
        .current-title{font-size:18px;font-weight:500;margin-bottom:8px;color:#fff}
        .video-info{font-size:13px;color:#aaa;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
        .status-badge{padding:3px 8px;background:#333;border-radius:3px;font-size:11px;display:inline-block}
        .status-badge.active{background:#ff0000}
        .additional-controls{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
        .control-item{display:flex;align-items:center;gap:6px;background:#2a2a2a;padding:6px 12px;border-radius:4px;font-size:12px;cursor:pointer;transition:background .2s}
        .control-item:hover{background:#333}
        .playlist-section{background:#212121;border-left:1px solid #333;display:flex;flex-direction:column}
        .playlist-header{padding:20px;border-bottom:1px solid #333}
        .search-box{position:relative;margin-bottom:15px}
        .search-input{width:100%;padding:10px 35px 10px 12px;border:1px solid #333;border-radius:20px;background:#0f0f0f;color:#fff;font-size:14px;outline:none}
        .search-input:focus{border-color:#666}
        .search-input::placeholder{color:#666}
        .search-icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);font-size:16px;color:#666}
        .playlist-title{font-size:16px;font-weight:500;color:#fff;display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
        .playlist-controls{display:flex;gap:8px}
        .shuffle-btn,.sort-btn{padding:6px 12px;font-size:12px;border-radius:15px;border:1px solid #333;background:transparent;color:#fff;cursor:pointer;transition:all .2s}
        .shuffle-btn:hover,.sort-btn:hover{background:#333}
        .shuffle-btn.active{background:#ff0000;border-color:#ff0000}
        .sort-menu{position:relative}
        .sort-dropdown{position:absolute;top:100%;right:0;background:#0f0f0f;border:1px solid #333;border-radius:4px;margin-top:5px;display:none;min-width:150px;z-index:100}
        .sort-dropdown.show{display:block}
        .sort-option{padding:10px 15px;cursor:pointer;font-size:13px;transition:background .2s}
        .sort-option:hover{background:#333}
        .sort-option.active{background:#ff0000}
        .playlist{flex:1;overflow-y:auto;padding:0 20px 20px}
        .playlist-item{padding:10px 12px;margin-bottom:2px;background:transparent;border-radius:4px;cursor:pointer;transition:background .2s;display:flex;align-items:center;gap:12px;position:relative}
        .playlist-item:hover{background:#333}
        .playlist-item.active{background:#333;border-left:3px solid #ff0000}
        .playlist-item-number{background:#333;padding:4px 8px;border-radius:4px;font-weight:500;min-width:35px;text-align:center;font-size:12px;color:#aaa}
        .playlist-item.active .playlist-item-number{background:#ff0000;color:#fff}
        .playlist-item-title{flex:1;font-size:14px;color:#fff}
        .favorite-btn{background:transparent;border:none;color:#666;cursor:pointer;font-size:16px;padding:4px;transition:color .2s}
        .favorite-btn:hover{color:#ff0000}
        .favorite-btn.active{color:#ff0000}
        .playlist::-webkit-scrollbar{width:6px}
        .playlist::-webkit-scrollbar-track{background:transparent}
        .playlist::-webkit-scrollbar-thumb{background:#333;border-radius:3px}
        .playlist::-webkit-scrollbar-thumb:hover{background:#555}
        .no-results,.loading{text-align:center;padding:40px 20px;color:#666;font-size:14px}
        .pip-indicator{position:fixed;bottom:20px;right:20px;background:rgba(0,0,0,.9);color:#fff;padding:10px 15px;border-radius:4px;font-size:12px;display:none;z-index:10000}
        .pip-indicator.show{display:block}
        .shortcuts-help{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.95);padding:30px;border-radius:8px;max-width:500px;display:none;z-index:10000}
        .shortcuts-help.show{display:block}
        .shortcuts-help h3{margin-bottom:20px;font-size:18px}
        .shortcut-list{display:grid;grid-template-columns:1fr 2fr;gap:12px;font-size:13px}
        .shortcut-key{background:#333;padding:4px 8px;border-radius:4px;text-align:center;font-weight:500}
        .shortcuts-close{position:absolute;top:10px;right:10px;background:transparent;border:none;color:#fff;font-size:24px;cursor:pointer;padding:5px}
        body.light-theme{background:#f5f5f5;color:#000}
        body.light-theme .header{background:#fff;border-bottom:1px solid #ddd}
        body.light-theme .header h1{color:#000}
        body.light-theme .player-section{background:#fff}
        body.light-theme .info-panel{background:#f0f0f0}
        body.light-theme .current-title{color:#000}
        body.light-theme .video-info{color:#666}
        body.light-theme .playlist-section{background:#f0f0f0;border-left:1px solid #ddd}
        body.light-theme .search-input{background:#fff;border:1px solid #ddd;color:#000}
        body.light-theme .playlist-item{color:#000}
        body.light-theme .playlist-item:hover{background:#e0e0e0}
        body.light-theme .playlist-item.active{background:#e0e0e0}
        body.light-theme .playlist-item-title{color:#000}
        @media (max-width:968px){.container{grid-template-columns:1fr}.playlist-section{border-left:none;border-top:1px solid #333}.control-buttons{font-size:14px}.btn{width:35px;height:35px;font-size:14px}}
        .icon-play::before{content:"‚ñ∂"}.icon-pause::before{content:"‚ùö‚ùö"}.icon-prev::before{content:"‚èÆ"}.icon-next::before{content:"‚è≠"}.icon-volume-high::before{content:"üîä"}.icon-volume-low::before{content:"üîâ"}.icon-volume-mute::before{content:"üîá"}.icon-fullscreen::before{content:"‚õ∂"}.icon-search::before{content:"üîç"}.icon-shuffle::before{content:"‚áÑ"}.icon-loop::before{content:"üîÅ"}.icon-pip::before{content:"‚ßâ"}.icon-favorite::before{content:"‚ô°"}.icon-favorite.active::before{content:"‚ô•"}
    </style>
</head>
<body>
    <div class="header">
        <h1>Video Player</h1>
        <div class="header-controls">
            <button class="theme-toggle" id="themeToggle">üåô Dark</button>
            <button class="theme-toggle" id="helpBtn">‚ùì Bantuan</button>
        </div>
    </div>

    <div class="container">
        <div class="player-section">
            <div class="video-wrapper">
                <video id="videoPlayer" preload="auto">
                    <source id="videoSource" src="" type="video/mp4">
                    Browser Anda tidak mendukung video player.
                </video>
                
                <div class="video-overlay" id="videoOverlay">
                    <div class="loading-spinner"></div>
                </div>
                
                <div class="controls">
                    <div class="progress-container">
                        <div class="progress-tooltip" id="progressTooltip">0:00</div>
                        <div class="progress-bar" id="progressBar">
                            <div class="buffer-progress" id="bufferProgress"></div>
                            <div class="progress" id="progress">
                                <div class="progress-handle"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-buttons">
                        <button class="btn icon-prev" id="prevBtn" title="Previous (P)"></button>
                        <button class="btn icon-play" id="playPauseBtn" title="Play/Pause (Space)"></button>
                        <button class="btn icon-next" id="nextBtn" title="Next (N)"></button>
                        <button class="btn icon-shuffle" id="shuffleBtn" title="Shuffle (S)"></button>
                        <button class="btn icon-loop" id="loopBtn" title="Loop (L)"></button>
                        
                        <div class="volume-control">
                            <button class="btn icon-volume-high" id="muteBtn" title="Mute (M)"></button>
                            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="70" title="Volume">
                        </div>
                        
                        <div class="speed-control">
                            <button class="btn speed-btn" id="speedBtn" title="Playback Speed">1x</button>
                            <div class="speed-menu" id="speedMenu">
                                <div class="speed-option" data-speed="0.25">0.25x</div>
                                <div class="speed-option" data-speed="0.5">0.5x</div>
                                <div class="speed-option" data-speed="0.75">0.75x</div>
                                <div class="speed-option active" data-speed="1">1x</div>
                                <div class="speed-option" data-speed="1.25">1.25x</div>
                                <div class="speed-option" data-speed="1.5">1.5x</div>
                                <div class="speed-option" data-speed="1.75">1.75x</div>
                                <div class="speed-option" data-speed="2">2x</div>
                            </div>
                        </div>
                        
                        <button class="btn icon-pip" id="pipBtn" title="Picture in Picture (I)"></button>
                        <button class="btn icon-fullscreen" id="fullscreenBtn" title="Fullscreen (F)"></button>
                        
                        <div class="time-display">
                            <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="info-panel">
                <div class="current-title" id="currentTitle">Pilih video untuk diputar</div>
                <div class="video-info">
                    <span>Total Video: <span id="totalVideos">Memuat...</span></span>
                    <div>
                        <span class="status-badge" id="loopStatus">Loop: OFF</span>
                        <span class="status-badge" id="shuffleStatus">Shuffle: OFF</span>
                        <span class="status-badge" id="autoplayStatus">Autoplay: ON</span>
                    </div>
                </div>
                <div class="additional-controls">
                    <label class="control-item">
                        <input type="checkbox" id="autoplayToggle" checked>
                        <span>Autoplay berikutnya</span>
                    </label>
                    <label class="control-item">
                        <input type="checkbox" id="rememberVolumeToggle" checked>
                        <span>Ingat volume</span>
                    </label>
                    <label class="control-item">
                        <input type="checkbox" id="rememberPositionToggle">
                        <span>Ingat posisi video</span>
                    </label>
                </div>
            </div>
        </div>

        <div class="playlist-section">
            <div class="playlist-header">
                <div class="search-box">
                    <input type="text" class="search-input" id="searchInput" placeholder="Cari video...">
                    <span class="search-icon icon-search"></span>
                </div>
                <div class="playlist-title">
                    <span>Daftar Video</span>
                    <div class="playlist-controls">
                        <button class="shuffle-btn" id="shuffleToggle">üîÄ ACAK</button>
                        <div class="sort-menu">
                            <button class="sort-btn" id="sortBtn">‚Üï URUT</button>
                            <div class="sort-dropdown" id="sortDropdown">
                                <div class="sort-option active" data-sort="number-asc">Nomor ‚Üë</div>
                                <div class="sort-option" data-sort="number-desc">Nomor ‚Üì</div>
                                <div class="sort-option" data-sort="title-asc">Judul A-Z</div>
                                <div class="sort-option" data-sort="title-desc">Judul Z-A</div>
                                <div class="sort-option" data-sort="favorites">Favorit</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="playlist">
                <div id="playlistContainer">
                    <div class="loading">Memuat daftar video...</div>
                </div>
            </div>
        </div>
    </div>

    <div class="pip-indicator" id="pipIndicator">üì∫ Mode Picture-in-Picture aktif</div>

    <div class="shortcuts-help" id="shortcutsHelp">
        <button class="shortcuts-close" id="shortcutsClose">√ó</button>
        <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
        <div class="shortcut-list">
            <div class="shortcut-key">Space</div><div>Play/Pause</div>
            <div class="shortcut-key">‚Üí</div><div>Maju 5 detik</div>
            <div class="shortcut-key">‚Üê</div><div>Mundur 5 detik</div>
            <div class="shortcut-key">‚Üë</div><div>Volume naik</div>
            <div class="shortcut-key">‚Üì</div><div>Volume turun</div>
            <div class="shortcut-key">M</div><div>Mute/Unmute</div>
            <div class="shortcut-key">F</div><div>Fullscreen</div>
            <div class="shortcut-key">I</div><div>Picture in Picture</div>
            <div class="shortcut-key">N</div><div>Video berikutnya</div>
            <div class="shortcut-key">P</div><div>Video sebelumnya</div>
            <div class="shortcut-key">S</div><div>Toggle Shuffle</div>
            <div class="shortcut-key">L</div><div>Toggle Loop</div>
            <div class="shortcut-key">?</div><div>Tampilkan bantuan ini</div>
        </div>
    </div>

    <script>
        const els={v:document.getElementById('videoPlayer'),vs:document.getElementById('videoSource'),vo:document.getElementById('videoOverlay'),ppb:document.getElementById('playPauseBtn'),pb:document.getElementById('prevBtn'),nb:document.getElementById('nextBtn'),sb:document.getElementById('shuffleBtn'),lb:document.getElementById('loopBtn'),pbar:document.getElementById('progressBar'),prog:document.getElementById('progress'),bprog:document.getElementById('bufferProgress'),ptt:document.getElementById('progressTooltip'),ct:document.getElementById('currentTime'),dur:document.getElementById('duration'),vs2:document.getElementById('volumeSlider'),mb:document.getElementById('muteBtn'),spb:document.getElementById('speedBtn'),spm:document.getElementById('speedMenu'),pipb:document.getElementById('pipBtn'),pipi:document.getElementById('pipIndicator'),fb:document.getElementById('fullscreenBtn'),title:document.getElementById('currentTitle'),tv:document.getElementById('totalVideos'),si:document.getElementById('searchInput'),pc:document.getElementById('playlistContainer'),st:document.getElementById('shuffleToggle'),ss:document.getElementById('shuffleStatus'),ls:document.getElementById('loopStatus'),as:document.getElementById('autoplayStatus'),at:document.getElementById('autoplayToggle'),rvt:document.getElementById('rememberVolumeToggle'),rpt:document.getElementById('rememberPositionToggle'),sortb:document.getElementById('sortBtn'),sortd:document.getElementById('sortDropdown'),tt:document.getElementById('themeToggle'),hb:document.getElementById('helpBtn'),sh:document.getElementById('shortcutsHelp'),sc:document.getElementById('shortcutsClose')};

        let videos=[],currentVideoIndex=0,filteredVideos=[],shuffleMode=false,loopMode=false,autoplayMode=true,shuffledIndices=[],shufflePosition=0,currentSort='number-asc',favorites=JSON.parse(localStorage.getItem('videoFavorites')||'[]');

        function loadPrefs(){const t=localStorage.getItem('theme')||'dark';t==='light'&&(document.body.classList.add('light-theme'),els.tt.textContent='‚òÄÔ∏è Light');if(els.rvt.checked){const v=localStorage.getItem('volume');v!==null&&(els.v.volume=parseFloat(v),els.vs2.value=parseFloat(v)*100)}else els.v.volume=.7,els.vs2.value=70;els.v.muted=false;const a=localStorage.getItem('autoplay');a!==null&&(autoplayMode=a==='true',els.at.checked=autoplayMode);const rv=localStorage.getItem('rememberVolume');rv!==null&&(els.rvt.checked=rv==='true');const rp=localStorage.getItem('rememberPosition');rp!==null&&(els.rpt.checked=rp==='true')}

        function shuffle(a){const s=[...a];for(let i=s.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[s[i],s[j]]=[s[j],s[i]]}return s}

        function genShuffle(){const idx=Array.from({length:videos.length},(a,i)=>i);shuffledIndices=shuffle(idx);const ci=shuffledIndices.indexOf(currentVideoIndex);ci>0&&([shuffledIndices[0],shuffledIndices[ci]]=[shuffledIndices[ci],shuffledIndices[0]]);shufflePosition=0}

        function toggleShuffle(){shuffleMode=!shuffleMode;shuffleMode?(genShuffle(),els.sb.classList.add('active'),els.st.classList.add('active'),els.ss.textContent='Shuffle: ON',els.ss.classList.add('active')):(els.sb.classList.remove('active'),els.st.classList.remove('active'),els.ss.textContent='Shuffle: OFF',els.ss.classList.remove('active'))}

        function toggleLoop(){loopMode=!loopMode;loopMode?(els.lb.classList.add('active'),els.ls.textContent='Loop: ON',els.ls.classList.add('active')):(els.lb.classList.remove('active'),els.ls.textContent='Loop: OFF',els.ls.classList.remove('active'))}

        function getNext(){return loopMode?currentVideoIndex:shuffleMode?(shufflePosition=(shufflePosition+1)%shuffledIndices.length,shuffledIndices[shufflePosition]):(currentVideoIndex+1)%videos.length}

        function getPrev(){return shuffleMode?(shufflePosition=(shufflePosition-1+shuffledIndices.length)%shuffledIndices.length,shuffledIndices[shufflePosition]):(currentVideoIndex-1+videos.length)%videos.length}

        async function detectVideos(){const av=[];for(const n of VIDEO_CONFIG.numbers){const vp=`${VIDEO_CONFIG.folder}${n}${VIDEO_CONFIG.extension}`;try{const r=await fetch(vp,{method:'HEAD'});r.ok&&av.push({number:n,title:`Video ${n}`,src:vp,isFavorite:favorites.includes(n)})}catch(e){continue}}return av}

        function sortVids(v,st){const s=[...v];switch(st){case 'number-asc':s.sort((a,b)=>a.number-b.number);break;case 'number-desc':s.sort((a,b)=>b.number-a.number);break;case 'title-asc':s.sort((a,b)=>a.title.localeCompare(b.title));break;case 'title-desc':s.sort((a,b)=>b.title.localeCompare(a.title));break;case 'favorites':s.sort((a,b)=>{if(a.isFavorite&&!b.isFavorite)return-1;if(!a.isFavorite&&b.isFavorite)return 1;return a.number-b.number})}return s}

        async function init(){try{videos=await detectVideos();videos=sortVids(videos,currentSort);filteredVideos=[...videos];els.tv.textContent=videos.length;renderPlaylist();if(videos.length>0){const lp=localStorage.getItem('lastPlayedVideo');if(lp&&els.rpt.checked){const li=videos.findIndex(v=>v.number===parseInt(lp));currentVideoIndex=li>=0?li:Math.floor(Math.random()*videos.length)}else currentVideoIndex=Math.floor(Math.random()*videos.length);loadVideo(currentVideoIndex);els.v.pause();updatePPIcon()}else els.pc.innerHTML='<div class="no-results">Tidak ada video ditemukan di folder assets/video/</div>'}catch(e){console.error('Error loading videos:',e);els.pc.innerHTML='<div class="no-results">Error memuat video</div>'}}

        function toggleFav(vn){const i=favorites.indexOf(vn);i>-1?favorites.splice(i,1):favorites.push(vn);localStorage.setItem('videoFavorites',JSON.stringify(favorites));const v=videos.find(v=>v.number===vn);v&&(v.isFavorite=!v.isFavorite);renderPlaylist()}

        function renderPlaylist(){els.pc.innerHTML='';if(filteredVideos.length===0){els.pc.innerHTML='<div class="no-results">Tidak ada video ditemukan</div>';return}filteredVideos.forEach(v=>{const item=document.createElement('div');item.className='playlist-item';videos[currentVideoIndex]===v&&item.classList.add('active');item.innerHTML=`<div class="playlist-item-number">${v.number}</div><div class="playlist-item-title">${v.title}</div><button class="favorite-btn icon-favorite ${v.isFavorite?'active':''}" data-number="${v.number}"></button>`;item.onclick=e=>{if(!e.target.classList.contains('favorite-btn')){const vi=videos.indexOf(v);loadVideo(vi);shuffleMode&&(shufflePosition=shuffledIndices.indexOf(vi))}};const fb=item.querySelector('.favorite-btn');fb.onclick=e=>{e.stopPropagation();toggleFav(v.number)};els.pc.appendChild(item)})}

        function loadVideo(i){if(i<0||i>=videos.length)return;currentVideoIndex=i;const v=videos[i];els.vo.classList.add('show');els.vs.src=v.src;els.v.load();els.v.muted=false;els.v.volume=els.vs2.value/100;if(els.rpt.checked){const sp=localStorage.getItem(`videoPosition_${v.number}`);sp&&(els.v.currentTime=parseFloat(sp))}els.v.addEventListener('loadeddata',function sf(){(!els.rpt.checked||!localStorage.getItem(`videoPosition_${v.number}`))&&(els.v.currentTime=.1);els.vo.classList.remove('show');els.v.removeEventListener('loadeddata',sf)});els.v.addEventListener('error',function(e){console.error('Error loading video:',e);els.title.textContent=`Error: ${v.title}`;els.vo.classList.remove('show')});els.title.textContent=v.title;localStorage.setItem('lastPlayedVideo',v.number);updateMuteIcon();renderPlaylist()}

        function updatePPIcon(){els.ppb.className=els.v.paused?'btn icon-play':'btn icon-pause'}

        function updateMuteIcon(){if(els.v.muted||els.v.volume===0)els.mb.className='btn icon-volume-mute';else if(els.v.volume<.5)els.mb.className='btn icon-volume-low';else els.mb.className='btn icon-volume-high'}

        function formatTime(s){if(!s||isNaN(s))return'0:00';const m=Math.floor(s/60);const sec=Math.floor(s%60);return`${m}:${sec.toString().padStart(2,'0')}`}

        loadPrefs();

        els.ppb.onclick=()=>els.v.paused?els.v.play():els.v.pause();
        els.v.onplay=updatePPIcon;
        els.v.onpause=updatePPIcon;

        els.v.ontimeupdate=()=>{if(els.v.duration){const p=(els.v.currentTime/els.v.duration)*100;els.prog.style.width=p+'%';els.ct.textContent=formatTime(els.v.currentTime);if(els.rpt.checked&&Math.floor(els.v.currentTime)%5===0){const v=videos[currentVideoIndex];localStorage.setItem(`videoPosition_${v.number}`,els.v.currentTime)}}};

        els.pb.onclick=()=>{const pi=getPrev();loadVideo(pi);els.v.play()};
        els.nb.onclick=()=>{const ni=getNext();loadVideo(ni);els.v.play()};
        els.sb.onclick=toggleShuffle;
        els.st.onclick=toggleShuffle;
        els.lb.onclick=toggleLoop;

        els.v.onended=()=>{if(autoplayMode&&!loopMode)els.nb.click();else if(loopMode)els.v.currentTime=0,els.v.play()};

        els.v.onloadedmetadata=()=>els.dur.textContent=formatTime(els.v.duration);

        els.v.onprogress=()=>{if(els.v.buffered.length>0){const b=els.v.buffered.end(els.v.buffered.length-1);const d=els.v.duration;d>0&&(els.bprog.style.width=(b/d*100)+'%')}};

        els.pbar.onclick=e=>{if(els.v.duration){const r=els.pbar.getBoundingClientRect();const p=(e.clientX-r.left)/r.width;els.v.currentTime=p*els.v.duration}};

        els.pbar.onmousemove=e=>{if(els.v.duration){const r=els.pbar.getBoundingClientRect();const p=(e.clientX-r.left)/r.width;const t=p*els.v.duration;els.ptt.textContent=formatTime(t);els.ptt.style.left=`${e.clientX-r.left}px`}};

        els.vs2.oninput=()=>{els.v.volume=els.vs2.value/100;els.v.muted=false;updateMuteIcon();els.rvt.checked&&localStorage.setItem('volume',els.v.volume)};

        els.mb.onclick=()=>{els.v.muted=!els.v.muted;updateMuteIcon()};

        els.spb.onclick=()=>els.spm.classList.toggle('show');

        document.querySelectorAll('.speed-option').forEach(o=>{o.onclick=()=>{const s=parseFloat(o.dataset.speed);els.v.playbackRate=s;els.spb.textContent=`${s}x`;document.querySelectorAll('.speed-option').forEach(op=>op.classList.remove('active'));o.classList.add('active');els.spm.classList.remove('show')}});

        els.pipb.onclick=async()=>{try{document.pictureInPictureElement?await document.exitPictureInPicture():await els.v.requestPictureInPicture()}catch(e){console.error('PiP error:',e);alert('Browser Anda tidak mendukung Picture-in-Picture')}};

        els.v.addEventListener('enterpictureinpicture',()=>{els.pipi.classList.add('show');els.pipb.classList.add('active')});
        els.v.addEventListener('leavepictureinpicture',()=>{els.pipi.classList.remove('show');els.pipb.classList.remove('active')});

        els.fb.onclick=()=>{document.fullscreenElement?document.exitFullscreen():els.v.requestFullscreen().catch(e=>console.error('Fullscreen error:',e))};

        document.addEventListener('fullscreenchange',()=>{els.fb.style.transform=document.fullscreenElement?'rotate(45deg)':'rotate(0deg)'});

        els.si.oninput=()=>{const q=els.si.value.toLowerCase();filteredVideos=videos.filter(v=>v.title.toLowerCase().includes(q)||v.number.toString().includes(q));renderPlaylist()};

        els.at.onchange=()=>{autoplayMode=els.at.checked;localStorage.setItem('autoplay',autoplayMode);els.as.textContent=autoplayMode?'Autoplay: ON':'Autoplay: OFF';els.as.classList.toggle('active',autoplayMode)};

        els.rvt.onchange=()=>{localStorage.setItem('rememberVolume',els.rvt.checked);els.rvt.checked&&localStorage.setItem('volume',els.v.volume)};

        els.rpt.onchange=()=>localStorage.setItem('rememberPosition',els.rpt.checked);

        els.sortb.onclick=()=>els.sortd.classList.toggle('show');

        document.querySelectorAll('.sort-option').forEach(o=>{o.onclick=()=>{currentSort=o.dataset.sort;document.querySelectorAll('.sort-option').forEach(op=>op.classList.remove('active'));o.classList.add('active');videos=sortVids(videos,currentSort);const q=els.si.value.toLowerCase();filteredVideos=q?videos.filter(v=>v.title.toLowerCase().includes(q)||v.number.toString().includes(q)):[...videos];renderPlaylist();els.sortd.classList.remove('show')}});

        els.tt.onclick=()=>{document.body.classList.toggle('light-theme');if(document.body.classList.contains('light-theme'))els.tt.textContent='‚òÄÔ∏è Light',localStorage.setItem('theme','light');else els.tt.textContent='üåô Dark',localStorage.setItem('theme','dark')};

        els.hb.onclick=()=>els.sh.classList.add('show');
        els.sc.onclick=()=>els.sh.classList.remove('show');
        els.sh.onclick=e=>e.target===els.sh&&els.sh.classList.remove('show');

        document.onclick=e=>{(!els.spb.contains(e.target)&&!els.spm.contains(e.target))&&els.spm.classList.remove('show');(!els.sortb.contains(e.target)&&!els.sortd.contains(e.target))&&els.sortd.classList.remove('show')};

        document.onkeydown=e=>{if(e.target===els.si)return;if(els.sh.classList.contains('show')&&e.key==='Escape'){els.sh.classList.remove('show');return}switch(e.key.toLowerCase()){case ' ':e.preventDefault();els.ppb.click();break;case 'arrowright':e.preventDefault();els.v.currentTime=Math.min(els.v.duration,els.v.currentTime+5);break;case 'arrowleft':e.preventDefault();els.v.currentTime=Math.max(0,els.v.currentTime-5);break;case 'arrowup':e.preventDefault();els.v.volume=Math.min(1,els.v.volume+.1);els.vs2.value=els.v.volume*100;els.v.muted=false;updateMuteIcon();els.rvt.checked&&localStorage.setItem('volume',els.v.volume);break;case 'arrowdown':e.preventDefault();els.v.volume=Math.max(0,els.v.volume-.1);els.vs2.value=els.v.volume*100;updateMuteIcon();els.rvt.checked&&localStorage.setItem('volume',els.v.volume);break;case 'm':e.preventDefault();els.mb.click();break;case 'f':e.preventDefault();els.fb.click();break;case 'i':e.preventDefault();els.pipb.click();break;case 'n':e.preventDefault();els.nb.click();break;case 'p':e.preventDefault();els.pb.click();break;case 's':e.preventDefault();toggleShuffle();break;case 'l':e.preventDefault();toggleLoop();break;case '?':e.preventDefault();els.sh.classList.toggle('show');break;case 'escape':e.preventDefault();document.fullscreenElement&&document.exitFullscreen();els.spm.classList.contains('show')&&els.spm.classList.remove('show');els.sortd.classList.contains('show')&&els.sortd.classList.remove('show');break;case '1':e.preventDefault();els.v.playbackRate=1;els.spb.textContent='1x';document.querySelectorAll('.speed-option').forEach(op=>op.classList.toggle('active',op.dataset.speed==='1'));break;case '2':e.preventDefault();els.v.playbackRate=2;els.spb.textContent='2x';document.querySelectorAll('.speed-option').forEach(op=>op.classList.toggle('active',op.dataset.speed==='2'));break;case '0':e.preventDefault();els.v.currentTime=0;break}};

        els.v.ondblclick=()=>els.fb.click();
        els.v.oncontextmenu=e=>{e.preventDefault();return false};
        els.v.addEventListener('waiting',()=>els.vo.classList.add('show'));
        els.v.addEventListener('canplay',()=>els.vo.classList.remove('show'));
        els.v.addEventListener('error',e=>{console.error('Video error:',e);els.vo.classList.remove('show');autoplayMode&&setTimeout(()=>els.nb.click(),2000)});

        els.as.textContent=autoplayMode?'Autoplay: ON':'Autoplay: OFF';
        els.as.classList.toggle('active',autoplayMode);

        if('mediaSession'in navigator){navigator.mediaSession.setActionHandler('play',()=>els.v.play());navigator.mediaSession.setActionHandler('pause',()=>els.v.pause());navigator.mediaSession.setActionHandler('previoustrack',()=>els.pb.click());navigator.mediaSession.setActionHandler('nexttrack',()=>els.nb.click());navigator.mediaSession.setActionHandler('seekbackward',()=>els.v.currentTime=Math.max(0,els.v.currentTime-10));navigator.mediaSession.setActionHandler('seekforward',()=>els.v.currentTime=Math.min(els.v.duration,els.v.currentTime+10));els.v.addEventListener('loadedmetadata',()=>{const v=videos[currentVideoIndex];navigator.mediaSession.metadata=new MediaMetadata({title:v.title,artist:'Video Player',album:'My Videos'})})}

        window.addEventListener('beforeunload',()=>{if(els.rpt.checked){const v=videos[currentVideoIndex];localStorage.setItem(`videoPosition_${v.number}`,els.v.currentTime)}});

        init();
        console.log('%cüé¨ Video Player','font-size:20px;font-weight:bold;color:#ff0000;');
        console.log('%cTekan ? untuk melihat keyboard shortcuts','font-size:12px;color:#666;');
    </script>
</body>
</html>
